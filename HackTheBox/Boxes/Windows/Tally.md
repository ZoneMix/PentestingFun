---
attachments: [Clipboard_2020-09-03-10-52-09.png, Clipboard_2020-09-03-10-54-00.png, Clipboard_2020-09-03-10-55-01.png, Clipboard_2020-09-03-11-15-20.png, Clipboard_2020-09-03-11-18-54.png, Clipboard_2020-09-03-12-36-44.png]
tags: [HTB]
title: Tally
created: '2020-09-03T06:19:08.491Z'
modified: '2020-09-03T20:59:57.981Z'
---

# Tally
- nmap shows many ports open
```
# Nmap 7.80 scan initiated Thu Sep  3 00:50:50 2020 as: nmap -vv --reason -Pn -A --osscan-guess --version-all -p- -oN /home/bailey/Documents/htb/boxes/Tally/10.10.10.59/scans/_full_tcp_nmap.txt -oX /home/bailey/Documents/htb/boxes/Tally/10.10.10.59/scans/xml/_full_tcp_nmap.xml 10.10.10.59
Increasing send delay for 10.10.10.59 from 5 to 10 due to 39 out of 128 dropped probes since last increase.
Increasing send delay for 10.10.10.59 from 20 to 40 due to 28 out of 93 dropped probes since last increase.
Increasing send delay for 10.10.10.59 from 40 to 80 due to 11 out of 27 dropped probes since last increase.
Nmap scan report for 10.10.10.59
Host is up, received user-set (0.21s latency).
Scanned at 2020-09-03 00:50:50 CDT for 32765s
Not shown: 65510 closed ports
Reason: 65510 conn-refused
PORT      STATE    SERVICE            REASON      VERSION
21/tcp    open     ftp                syn-ack     Microsoft ftpd
| ftp-syst: 
|_  SYST: Windows_NT
80/tcp    open     http               syn-ack     Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
| http-methods: 
|_  Supported Methods: OPTIONS
| http-ntlm-info: 
|   Target_Name: TALLY
|   NetBIOS_Domain_Name: TALLY
|   NetBIOS_Computer_Name: TALLY
|   DNS_Domain_Name: TALLY
|   DNS_Computer_Name: TALLY
|_  Product_Version: 10.0.14393
81/tcp    open     http               syn-ack     Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Bad Request
135/tcp   open     msrpc              syn-ack     Microsoft Windows RPC
139/tcp   open     netbios-ssn        syn-ack     Microsoft Windows netbios-ssn
445/tcp   open     microsoft-ds       syn-ack     Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
808/tcp   open     ccproxy-http?      syn-ack
1433/tcp  open     ms-sql-s           syn-ack     Microsoft SQL Server 2016 13.00.1601.00; RTM
| ms-sql-ntlm-info: 
|   Target_Name: TALLY
|   NetBIOS_Domain_Name: TALLY
|   NetBIOS_Computer_Name: TALLY
|   DNS_Domain_Name: TALLY
|   DNS_Computer_Name: TALLY
|_  Product_Version: 10.0.14393
| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
| Issuer: commonName=SSL_Self_Signed_Fallback
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2020-09-03T05:47:35
| Not valid after:  2050-09-03T05:47:35
| MD5:   acd4 d1ea 8b07 1f2b 45c2 81d5 bd9b 5284
| SHA-1: 9f0e 0a06 efea e2b9 3390 db0e ae1c f319 7023 281f
| -----BEGIN CERTIFICATE-----
| MIIDADCCAeigAwIBAgIQX5qJAX+LUJ1B4ktSHWlc8jANBgkqhkiG9w0BAQUFADA7
| MTkwNwYDVQQDHjAAUwBTAEwAXwBTAGUAbABmAF8AUwBpAGcAbgBlAGQAXwBGAGEA
| bABsAGIAYQBjAGswIBcNMjAwOTAzMDU0NzM1WhgPMjA1MDA5MDMwNTQ3MzVaMDsx
| OTA3BgNVBAMeMABTAFMATABfAFMAZQBsAGYAXwBTAGkAZwBuAGUAZABfAEYAYQBs
| AGwAYgBhAGMAazCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALh9G6Aq
| fNEwsrBShRaQRbP3rE2m+VipSRwCHXXupZ3ZwmHjiRRlPonhRwv3r5UMF/U/l/r/
| 2a9TrL/dfuHylQB6TNhpd8Gvfa2Sxjpz23tGo5BaQ9Rj1V2Wsq+YP0sakHWHWQ+2
| rbKrxYGtVtWTOo8ys73i4JzxXn3U023cwGHRR/N9us5BBKZrcLnKfsubSPCNxRl0
| +c36IhCcGd2oWUkBy2Qi4CXZehCRR0MTuM9HkTIUgWQmq0AMbokU06ZrbiypQyVJ
| 0o7OWvb9vQu2RmyV41hiEUApaDqHnPrrf25RuBb3UaHJ2hxFOLU+kXrvh3aPwuAu
| C64KGaeIcc1rDV8CAwEAATANBgkqhkiG9w0BAQUFAAOCAQEAS3yvshfuRIthPBsK
| 877kpvjSr3I5GnWDHUwZrBeMGQPLGwU4y9oXqPVxUauVs7A0JFlHt9zYgBY59TJx
| geZs81fLhC9WmD4R6UW/2UHOPLPxduFAG1M6+UlqW09cxl5GISxMmHz/L79kRBJW
| KzilUx2gfNQABnIXcxY+jNR1Qt+81G1nuGbMU2UWJbb8Nf7ywZ6aWirD6cEII/sg
| qog9Tm3VhpA2qa+dIZjsedjDppsPQ2uQsteQqIDGwO7WT0O+1qp9bjNVfP/watkX
| orNzoJ0pephjtJ8cAA/BS6IFZjl4yBb6rh88was39Z4n2Pws1aBxi/SUK+BJp/QT
| z3IK/A==
|_-----END CERTIFICATE-----
|_ssl-date: 2020-09-03T14:59:34+00:00; +2m47s from scanner time.
| vulners: 
|   cpe:/a:microsoft:sql_server:2016: 
|     	CVE-2020-0618	6.5	https://vulners.com/cve/CVE-2020-0618
|     	CVE-2019-1068	6.5	https://vulners.com/cve/CVE-2019-1068
|     	CVE-2016-7250	6.5	https://vulners.com/cve/CVE-2016-7250
|     	CVE-2016-7249	6.5	https://vulners.com/cve/CVE-2016-7249
|     	CVE-2017-8516	5.0	https://vulners.com/cve/CVE-2017-8516
|     	CVE-2016-7251	4.3	https://vulners.com/cve/CVE-2016-7251
|_    	CVE-2016-7252	4.0	https://vulners.com/cve/CVE-2016-7252
5985/tcp  open     http               syn-ack     Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
7279/tcp  filtered ctxlic             no-response
15567/tcp open     http               syn-ack     Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
| http-methods: 
|_  Supported Methods: HEAD POST OPTIONS
| http-ntlm-info: 
|   Target_Name: TALLY
|   NetBIOS_Domain_Name: TALLY
|   NetBIOS_Computer_Name: TALLY
|   DNS_Domain_Name: TALLY
|   DNS_Computer_Name: TALLY
|_  Product_Version: 10.0.14393
|_http-server-header: Microsoft-IIS/10.0
17408/tcp filtered unknown            no-response
32843/tcp open     http               syn-ack     Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Service Unavailable
32844/tcp open     ssl/http           syn-ack     Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
| ssl-cert: Subject: commonName=SharePoint Services/organizationName=Microsoft/countryName=US/organizationalUnitName=SharePoint
| Subject Alternative Name: DNS:localhost, DNS:tally
| Issuer: commonName=SharePoint Root Authority/organizationName=Microsoft/countryName=US/organizationalUnitName=SharePoint
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2017-09-17T22:51:16
| Not valid after:  9999-01-01T00:00:00
| MD5:   965f 55d6 a0b1 fed5 4ce5 3887 2938 0d53
| SHA-1: 0f6a 3c08 bee8 b7ad 237e 9759 e91c f683 8f0b 149f
| -----BEGIN CERTIFICATE-----
| MIIEWTCCAkGgAwIBAgIQyV6dVL5Kk6BEr58pxdsV6TANBgkqhkiG9w0BAQUFADBa
| MQswCQYDVQQGEwJVUzESMBAGA1UEChMJTWljcm9zb2Z0MRMwEQYDVQQLEwpTaGFy
| ZVBvaW50MSIwIAYDVQQDExlTaGFyZVBvaW50IFJvb3QgQXV0aG9yaXR5MCAXDTE3
| MDkxNzIyNTExNloYDzk5OTkwMTAxMDAwMDAwWjBUMQswCQYDVQQGEwJVUzESMBAG
| A1UEChMJTWljcm9zb2Z0MRMwEQYDVQQLEwpTaGFyZVBvaW50MRwwGgYDVQQDExNT
| aGFyZVBvaW50IFNlcnZpY2VzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC
| AQEApN4ZSEX3h7SYbASpHe0GGBydQQR3fhCyDV9qhj/Vx5ciK4ncVZTahAbVenN8
| 9xNPloxMcqadhp3WwOhr77MZ6X/P8SnbpFoKVFCUVxXIBhVZQ3sAqZ2oI5+6VOYn
| UqkzYE5UFYnlA8tSfNgpCeZ4gNhr3VNmxXx+5SaUufm2qLKJn93RGvnRYF0abTBz
| 5wbjjjELmq6+2eRjNbk24mzMWiVI/yW5Ea7BturA6YqumRvhqXgqgSjiD/OfDPXI
| J0kimJuHre6MGFPBDmYFa47W+NLZxW6j4POQasady+98CHvM88456TCp9WvWH6R6
| DxKdmWrA+A6qJkr7rTP5n5oJCQIDAQABox8wHTAbBgNVHREEFDASgglsb2NhbGhv
| c3SCBXRhbGx5MA0GCSqGSIb3DQEBBQUAA4ICAQBGkHAoLvIgw3mH6EyflnMyWREG
| yEZ02iUx/I0yJDUp6gnEgHNeNh0dnqNOjvyQktFG1+e+VFgt5kSI4sUlGSkFasDf
| fcnFUcM6iq6bRZzWNgYyhrYBaPgr50oaZZs4qEJufObrmeD6rL37URiO7tFE/UOM
| 77AipPQ8j7BVGwCG++XEYQPpYt1fo/N/aCrdY4akz2rKQ+GmoO6V429ovTJtO+z0
| qJID3JUhYjA2ZiL6Are4+L6eZAlnxFR45W2p1XS2by+J4AxSGj1aZGVE83ngrdi9
| F/WB6IIInpFsDiCYgDdyqIR/7xR+iiIdwqsHBZ6OU0YV5UBkWAOjUHIoJkp6rJ9L
| RtcQBlyRSEEiFVn1tU4GK7Sb5E+HsSBpvFA8K1vKZDP+N4J83ii1p6esaZ6g0oy3
| tMY9E+v6xQkzXjCb1ZW2jBSqZK7Bzb/SKcjOnzDvDeKZwJY8RUEHpVVEhwj752ml
| Xr95eiWQsuzJyB2cJ5jwiL+uBWcswrjFLQk+zpY/jx0WXnBS8aEGnyohmbQ1POcg
| ETpi4jhYGmFG4EJyHv25c2k3JvvrY4HufeUQg5qWljLG+UCSgnZrpDgIv4/pTSZ1
| ICd9gsCOZZ44qx9OwP25yxb165VU+kDt218w2WSrBwxuk6D59jjQw9z3+/kCZug9
| ox1fB7OQe5ABVPlttQ==
|_-----END CERTIFICATE-----
|_ssl-date: 2020-09-03T14:59:34+00:00; +2m49s from scanner time.
| tls-alpn: 
|   h2
|_  http/1.1
32846/tcp open     storagecraft-image syn-ack     StorageCraft Image Manager
37137/tcp filtered unknown            no-response
38073/tcp filtered unknown            no-response
47001/tcp open     http               syn-ack     Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49664/tcp open     msrpc              syn-ack     Microsoft Windows RPC
49665/tcp open     msrpc              syn-ack     Microsoft Windows RPC
49666/tcp open     msrpc              syn-ack     Microsoft Windows RPC
49667/tcp open     msrpc              syn-ack     Microsoft Windows RPC
49668/tcp open     msrpc              syn-ack     Microsoft Windows RPC
49669/tcp open     msrpc              syn-ack     Microsoft Windows RPC
49670/tcp open     msrpc              syn-ack     Microsoft Windows RPC
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 2m47s, deviation: 0s, median: 2m47s
| ms-sql-info: 
|   10.10.10.59:1433: 
|     Version: 
|       name: Microsoft SQL Server 2016 RTM
|       number: 13.00.1601.00
|       Product: Microsoft SQL Server 2016
|       Service pack level: RTM
|       Post-SP patches applied: false
|_    TCP port: 1433
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 38206/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 33697/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 15170/udp): CLEAN (Failed to receive data)
|   Check 4 (port 55012/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)
| smb-security-mode: 
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-09-03T14:59:21
|_  start_date: 2020-09-03T05:47:13

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Thu Sep  3 09:56:55 2020 -- 1 IP address (1 host up) scanned in 32764.83 seconds

```

going to port 80 we see that it is a sharepoint box

![](@attachment/Clipboard_2020-09-03-10-52-09.png)

using gobuster with the sharepoint wordlists, we can see there are many files that it found, this can take some time, but patience is key when enumerating

```
go.txt

/_app_bin (Status: 403)
/_layouts/1033 (Status: 403)
/_controltemplates (Status: 403)
/_layouts (Status: 403)
/_layouts/1033/avreport.htm (Status: 200)
/_layouts/1033/error.htm (Status: 200)
/_layouts/1033/fontdlg.htm (Status: 200)
/_layouts/1033/filedlg.htm (Status: 200)
/_layouts/1033/iframe.htm (Status: 200)
/_layouts/1033/instable.htm (Status: 200)
/_layouts/1033/images (Status: 403)
/_layouts/1033/menu.htc (Status: 200)
/_layouts/1033/menubar.htc (Status: 200)
/_catalogs/wp/forms/allitems.aspx (Status: 200)
/_catalogs/masterpage/forms/allitems.aspx (Status: 200)
/_catalogs/lt/forms/allitems.aspx (Status: 200)
/_layouts/1033/selcolor.htm (Status: 200)
/_layouts/1033/spthemes.xml (Status: 200)
/_layouts/1033/spthemes.xsd (Status: 200)
/_layouts/addcontentsource.aspx (Status: 200)
/_layouts/addfiletype.aspx (Status: 200)
/_layouts/addnavigationlinkdialog.aspx (Status: 200)
/_layouts/addservernamemappings.aspx (Status: 200)
/_layouts/accessdenied.aspx (Status: 401)
/_layouts/areacachesettings.aspx (Status: 200)
/_layouts/areanavigationsettings.aspx (Status: 200)
/_layouts/areatemplatesettings.aspx (Status: 200)
/_layouts/areawelcomepage.aspx (Status: 200)
/_layouts/addwrkfl.aspx (Status: 401)
/_layouts/addrole.aspx (Status: 401)
/_layouts/approve.aspx (Status: 401)
/_layouts/advsetng.aspx (Status: 401)
/_layouts/assetedithyperlink.aspx (Status: 200)
/_layouts/assetuploader.aspx (Status: 200)
/_layouts/assetportalbrowser.aspx (Status: 200)
/_layouts/assetimagepicker.aspx (Status: 200)
/_layouts/aspxform.aspx (Status: 200)
/_layouts/audience_edit.aspx (Status: 200)
/_layouts/audience_defruleedit.aspx (Status: 200)
/_layouts/audience_view.aspx (Status: 200)
/_layouts/audience_memberlist.aspx (Status: 200)
/_layouts/audience_list.aspx (Status: 200)
/_layouts/auditsettings.aspx (Status: 200)
/_layouts/audience_sched.aspx (Status: 200)
/_layouts/audience_main.aspx (Status: 200)
/_layouts/authenticate.aspx (Status: 401)
/_layouts/bdcadminui/addbdcaction.aspx (Status: 200)
/_layouts/barcodeimagefromitem.aspx (Status: 200)
/_layouts/bdcadminui/bdcentities.aspx (Status: 200)
/_layouts/bdcadminui/addbdcapplication.aspx (Status: 200)
/_layouts/bdcadminui/bdcapplications.aspx (Status: 200)
/_layouts/bdcadminui/exportbdcapplication.aspx (Status: 200)
/_layouts/bdcadminui/viewbdcentity.aspx (Status: 200)
/_layouts/associatedgroups.aspx (Status: 401)
/_layouts/assocwrkfl.aspx (Status: 401)
/_layouts/avreport.aspx (Status: 401)
/_layouts/backlinks.aspx (Status: 401)
/_layouts/bulkwrktaskhandler.aspx (Status: 200)
/_layouts/bdcadminui/viewbdcapplication.aspx (Status: 200)
/_layouts/bdcadminui/editbdcaction.aspx (Status: 200)
/_layouts/bdcadminui/managepermissions.aspx (Status: 200)
/_layouts/bestbet.aspx (Status: 401)
/_layouts/bulkwrktaskip.aspx (Status: 200)
/_layouts/cmsslwpaddeditgroup.aspx (Status: 200)
/_layouts/changesitemasterpage.aspx (Status: 200)
/_layouts/cmsslwpaddeditlink.aspx (Status: 200)
/_layouts/changecontenttypeorder.aspx (Status: 401)
/_layouts/bpcf.aspx (Status: 401)
/_layouts/checkin.aspx (Status: 401)
/_layouts/category.aspx (Status: 401)
/_layouts/changecontenttypeoptionalsettings.aspx (Status: 401)
/_layouts/businessdatasynchronizer.aspx (Status: 401)
/_layouts/changefieldorder.aspx (Status: 401)
/_layouts/cmsslwpsortlinks.aspx (Status: 200)
/_layouts/cmsslwpeditview.aspx (Status: 200)
/_layouts/confirmation.aspx (Status: 401)
/_layouts/convertersettings.aspx (Status: 200)
/_layouts/contentaccessaccount.aspx (Status: 200)
/_layouts/contenttypeconvertersettings.aspx (Status: 200)
/_layouts/conngps.aspx (Status: 200)
/_layouts/containerpicker.aspx (Status: 200)
/_layouts/copy.aspx (Status: 401)
/_layouts/copyresults.aspx (Status: 401)
/_layouts/copyutil.aspx (Status: 200)
/_layouts/copyrole.aspx (Status: 401)
/_layouts/createpage.aspx (Status: 200)
/_layouts/createworkbook.aspx (Status: 200)
/_layouts/createadaccount.aspx (Status: 200)
/_layouts/crawledproperty.aspx (Status: 401)
/_layouts/createwebpage.aspx (Status: 401)
/_layouts/customizereport.aspx (Status: 200)
/_layouts/ctdmsettings.aspx (Status: 200)
/_layouts/cstwrkflip.aspx (Status: 200)
/_layouts/dmplaceholder.aspx (Status: 200)
/_layouts/deletemu.aspx (Status: 401)
/_layouts/discbar.aspx (Status: 200)
/_layouts/create.aspx (Status: 401)
/_layouts/createws.aspx (Status: 401)
/_layouts/ctypenew.aspx (Status: 401)
/_layouts/ctypedit.aspx (Status: 401)
/_layouts/deactivatefeature.aspx (Status: 401)
/_layouts/dladvopt.aspx (Status: 401)
/_layouts/dynamicimageprovider.aspx (Status: 200)
/_layouts/deleteweb.aspx (Status: 401)
/_layouts/dws.aspx (Status: 401)
/_layouts/download.aspx (Status: 401)
/_layouts/editcrawlrule.aspx (Status: 200)
/_layouts/editcontentsource.aspx (Status: 200)
/_layouts/editdsserver.aspx (Status: 200)
/_layouts/editpolicy.aspx (Status: 200)
/_layouts/editprofile.aspx (Status: 200)
/_layouts/editrelevancesettings.aspx (Status: 200)
/_layouts/editpropertynames.aspx (Status: 200)
/_layouts/editpropertynames2.aspx (Status: 200)
/_layouts/editproperty.aspx (Status: 200)
/_layouts/doctrans.aspx (Status: 401)
/_layouts/editcopyinformation.aspx (Status: 401)
/_layouts/editnav.aspx (Status: 401)
/_layouts/editgrp.aspx (Status: 401)
/_layouts/editrole.aspx (Status: 401)
/_layouts/editschedule.aspx (Status: 200)
/_layouts/editsection.aspx (Status: 200)
/_layouts/editprms.aspx (Status: 401)
/_layouts/editview.aspx (Status: 401)
/_layouts/emaildetails.aspx (Status: 401)
/_layouts/ewrfind.aspx (Status: 200)
/_layouts/ewrtop10.aspx (Status: 200)
/_layouts/ewrpredialog.aspx (Status: 200)
/_layouts/enablealerts.aspx (Status: 200)
/_layouts/ewrcustomfilter.aspx (Status: 200)
/_layouts/excelcellpicker.aspx (Status: 200)
/_layouts/ewrfilter.aspx (Status: 200)
/_layouts/error.aspx (Status: 200)
/_layouts/emailsettings.aspx (Status: 401)
/_layouts/enhancedsearch.aspx (Status: 401)
/_layouts/excelrenderer.aspx (Status: 200)
/_layouts/excelprofilepage.aspx (Status: 200)
/_layouts/excelserversafedataprovider.aspx (Status: 200)
/_layouts/excelservertrustedlocation.aspx (Status: 200)
/_layouts/exemptpolicy.aspx (Status: 200)
/_layouts/excelserveruserdefinedfunctions.aspx (Status: 200)
/_layouts/excelservertrustedlocations.aspx (Status: 200)
/_layouts/excelserversafedataproviders.aspx (Status: 200)
/_layouts/excelserversettings.aspx (Status: 200)
/_layouts/excelservertrusteddcl.aspx (Status: 200)
/_layouts/exportpolicy.aspx (Status: 200)
/_layouts/excelservertrusteddcls.aspx (Status: 200)
/_layouts/excelserveruserdefinedfunction.aspx (Status: 200)
/_layouts/feed.aspx (Status: 200)
/_layouts/folders.aspx (Status: 200)
/_layouts/filtervaluespickerdialog.aspx (Status: 200)
/_layouts/filter.aspx (Status: 200)
/_layouts/formresource.aspx (Status: 200)
/_layouts/formserver.aspx (Status: 200)
/_layouts/fldnewex.aspx (Status: 401)
/_layouts/fldedit.aspx (Status: 401)
/_layouts/fldnew.aspx (Status: 401)
/_layouts/fldeditex.aspx (Status: 401)
/_layouts/formedt.aspx (Status: 401)
/_layouts/fldpick.aspx (Status: 401)
/_layouts/formserverattachments.aspx (Status: 200)
/_layouts/formserverdetector.aspx (Status: 200)
/_layouts/gear.aspx (Status: 200)
/_layouts/genericpicker.aspx (Status: 401)
/_layouts/getdataconnectionfile.aspx (Status: 200)
/_layouts/getssploginfo.aspx (Status: 200)
/_layouts/getsspscopes.aspx (Status: 200)
/_layouts/getsspstatus.aspx (Status: 200)
/_layouts/hold.aspx (Status: 200)
/_layouts/holdreport.aspx (Status: 200)
/_layouts/helpsearch.aspx (Status: 200)
/_layouts/htmltrverify.aspx (Status: 200)
/_layouts/htmltranslate.aspx (Status: 200)
/_layouts/helpcontent.aspx (Status: 200)
/_layouts/htmltrredir.aspx (Status: 200)
/_layouts/htmledit.aspx (Status: 200)
/_layouts/images/ (Status: 403)
/_layouts/iniwrkflip.aspx (Status: 200)
/_layouts/importpolicy.aspx (Status: 200)
/_layouts/groups.aspx (Status: 401)
/_layouts/iviewhost.aspx (Status: 200)
/_layouts/iframe.aspx (Status: 200)
/_layouts/itemrwfassoc.aspx (Status: 200)
/_layouts/indxcol.aspx (Status: 401)
/_layouts/infopage.aspx (Status: 401)
/_layouts/irm.aspx (Status: 401)
/_layouts/irmrept.aspx (Status: 401)
/_layouts/keyword.aspx (Status: 401)
/_layouts/labelimage.aspx (Status: 200)
/_layouts/linkschecker.aspx (Status: 200)
/_layouts/linkscheckerwiz.aspx (Status: 200)
/_layouts/listcontentsources.aspx (Status: 200)
/_layouts/listenabletargeting.aspx (Status: 200)
/_layouts/listedit.aspx (Status: 200)
/_layouts/listservernamemappings.aspx (Status: 200)
/_layouts/listfeed.aspx (Status: 200)
/_layouts/listsyndication.aspx (Status: 401)
/_layouts/listgeneralsettings.aspx (Status: 401)
/_layouts/logsummary.aspx (Status: 200)
/_layouts/listkeywords.aspx (Status: 200)
/_layouts/logviewer.aspx (Status: 200)
/_layouts/longrunningoperationprogress.aspx (Status: 200)
/_layouts/lroperationstatus.aspx (Status: 200)
/_layouts/managecrawlrules.aspx (Status: 200)
/_layouts/lstsetng.aspx (Status: 401)
/_layouts/managefeatures.aspx (Status: 401)
/_layouts/managecopies.aspx (Status: 401)
/_layouts/managecontenttype.aspx (Status: 401)
/_layouts/managecontenttypefield.aspx (Status: 401)
/_layouts/managedproperty.aspx (Status: 401)
/_layouts/manageprivacypolicy.aspx (Status: 200)
/_layouts/manageitemscheduling.aspx (Status: 200)
/_layouts/managefiletypes.aspx (Status: 200)
/_layouts/manageservicepermissions.aspx (Status: 200)
/_layouts/mgrdsserver.aspx (Status: 200)
/_layouts/mgrproperty.aspx (Status: 200)
/_layouts/metaweblog.aspx (Status: 200)
/_layouts/managefeatures.aspx?scope=site (Status: 401)
/_layouts/managecheckedoutfiles.aspx (Status: 401)
/_layouts/mcontent.aspx (Status: 401)
/_layouts/matchingrule.aspx (Status: 401)
/_layouts/mngdisc.aspx (Status: 200)
/_layouts/mngsubwebs.aspx?view=sites (Status: 401)
/_layouts/mobile/mbllogout.aspx (Status: 200)
/_layouts/mobile/mobileformserver.aspx (Status: 200)
/_layouts/mobile/mbllogin.aspx (Status: 200)
/_layouts/nocrawlsettings.aspx (Status: 200)
/_layouts/officialfilesetup.aspx (Status: 200)
/_layouts/pagesettings.aspx (Status: 200)
/_layouts/objectcachesettings.aspx (Status: 200)
/_layouts/newtranslationmanagement.aspx (Status: 200)
/_layouts/officialfilesuccess.aspx (Status: 200)
/_layouts/pageversioninfo.aspx (Status: 200)
/_layouts/newvariationsite.aspx (Status: 200)
/_layouts/policy.aspx (Status: 200)
/_layouts/pickertreeview.aspx (Status: 200)
/_layouts/personalsites.aspx (Status: 200)
/_layouts/pickerresult.aspx (Status: 200)
/_layouts/picker.aspx (Status: 200)
/_layouts/policycts.aspx (Status: 200)
/_layouts/policyconfig.aspx (Status: 200)
/_layouts/policylist.aspx (Status: 200)
/_layouts/portalview.aspx (Status: 401)
/_layouts/printloader.formserver.aspx (Status: 200)
/_layouts/postback.formserver.aspx (Status: 200)
/_layouts/print.formserver.aspx (Status: 200)
/_layouts/password.aspx (Status: 401)
/_layouts/portal.aspx (Status: 401)
/_layouts/profmngr.aspx (Status: 200)
/_layouts/profmain.aspx (Status: 200)
/_layouts/profadminedit.aspx (Status: 200)
/_layouts/permsetup.aspx (Status: 401)
/_layouts/prjsetng.aspx (Status: 401)
/_layouts/profileredirect.aspx (Status: 401)
/_layouts/people.aspx?membershipgroupid=0 (Status: 401)
/_layouts/people.aspx (Status: 401)
/_layouts/profnew.aspx (Status: 200)
/_layouts/proxy.aspx (Status: 200)
/_layouts/quicklinksdialogform.aspx (Status: 200)
/_layouts/quicklinksdialog.aspx (Status: 200)
/_layouts/quicklinksdialog2.aspx (Status: 200)
/_layouts/quicklinks.aspx (Status: 200)
/_layouts/publishback.aspx (Status: 401)
/_layouts/qstedit.aspx (Status: 401)
/_layouts/qlreord.aspx (Status: 401)
/_layouts/qstnew.aspx (Status: 401)
/_layouts/redirectpage.aspx (Status: 200)
/_layouts/redirectpage.aspx?target={sitecollectionurl}_catalogs/masterpage (Status: 200)
/_layouts/quiklnch.aspx (Status: 401)
/_layouts/rcxform.aspx (Status: 200)
/_layouts/redirect.aspx (Status: 200)
/_layouts/regionalsetng.aspx (Status: 401)
/_layouts/reghost.aspx (Status: 401)
/_layouts/renderudc.aspx (Status: 200)
/_layouts/releasehold.aspx (Status: 200)
/_layouts/rellinksscopesettings.aspx (Status: 200)
/_layouts/recyclebin.aspx (Status: 401)
/_layouts/remwrkfl.aspx (Status: 401)
/_layouts/reorder.aspx (Status: 200)
/_layouts/resolverecipient.aspx (Status: 200)
/_layouts/reusabletextpicker.aspx (Status: 200)
/_layouts/reqacc.aspx (Status: 401)
/_layouts/rfcxform.aspx (Status: 200)
/_layouts/reporting.aspx (Status: 200)
/_layouts/reqgroup.aspx (Status: 200)
/_layouts/reqgroupconfirm.aspx (Status: 401)
/_layouts/reqfeatures.aspx (Status: 401)
/_layouts/rfpxform.aspx (Status: 200)
/_layouts/role.aspx (Status: 401)
/_layouts/schema.aspx (Status: 200)
/_layouts/rte2ecell.aspx (Status: 200)
/_layouts/rte2erowcolsize.aspx (Status: 200)
/_layouts/rte2etable.aspx (Status: 200)
/_layouts/runreport.aspx (Status: 200)
/_layouts/rte2pueditor.aspx (Status: 200)
/_layouts/rssxslt.aspx (Status: 200)
/_layouts/searchresultremoval.aspx (Status: 200)
/_layouts/searchandaddtohold.aspx (Status: 200)
/_layouts/searchreset.aspx (Status: 200)
/_layouts/searchsspsettings.aspx (Status: 200)
/_layouts/scsignup.aspx (Status: 401)
/_layouts/savetmpl.aspx (Status: 401)
/_layouts/scopedisplaygroup.aspx (Status: 401)
/_layouts/selectcrawledproperty.aspx (Status: 401)
/_layouts/scope.aspx (Status: 401)
/_layouts/rtedialog.aspx (Status: 200)
/_layouts/selectpicture.aspx (Status: 200)
/_layouts/selectpicture2.aspx (Status: 200)
/_layouts/sendtoofficialfile.aspx (Status: 401)
/_layouts/setimport.aspx (Status: 200)
/_layouts/searchresults.aspx (Status: 200)
/_layouts/selectuser.aspx (Status: 200)
/_layouts/signatureeula.formserver.aspx (Status: 200)
/_layouts/signaturedetailspngloader.formserver.aspx (Status: 200)
/_layouts/signaturedetailsloader.formserver.aspx (Status: 200)
/_layouts/signature.formserver.aspx (Status: 200)
/_layouts/signaturedetails.formserver.aspx (Status: 200)
/_layouts/sitedirectorysettings.aspx (Status: 200)
/_layouts/sitemanager.aspx (Status: 200)
/_layouts/sitecachesettings.aspx (Status: 200)
/_layouts/sitemanager.aspx?lro=all (Status: 200)
/_layouts/setanon.aspx (Status: 401)
/_layouts/setrqacc.aspx (Status: 401)
/_layouts/settings.aspx (Status: 401)
/_layouts/smtcommentsdialog.aspx (Status: 200)
/_layouts/slnew.aspx (Status: 200)
/_layouts/sledit.aspx (Status: 200)
/_layouts/signout.aspx (Status: 200)
/_layouts/spcf.aspx (Status: 401)
/_layouts/sitesubs.aspx (Status: 401)
/_layouts/siterss.aspx (Status: 401)
/_layouts/spellchecker.aspx (Status: 200)
/_layouts/spnewdashboard.aspx (Status: 200)
/_layouts/spusageconfig.aspx (Status: 200)
/_layouts/spsredirect.aspx (Status: 200)
/_layouts/spusagesite.aspx (Status: 200)
/_layouts/spusagesiteclickthroughs.aspx (Status: 200)
/_layouts/spusagesitesearchqueries.aspx (Status: 200)
/_layouts/spcontnt.aspx (Status: 401)
/_layouts/spusagesitehomepage.aspx (Status: 200)
/_layouts/spusageweb.aspx (Status: 200)
/_layouts/spusagesspsearchqueries.aspx (Status: 200)
/_layouts/spusagesitereferrers.aspx (Status: 200)
/_layouts/spusagesitesearchresults.aspx (Status: 200)
/_layouts/spusagesitetoppages.aspx (Status: 200)
/_layouts/spusagesiteusers.aspx (Status: 200)
/_layouts/spusagesspsearchresults.aspx (Status: 200)
/_layouts/spusagewebclickthroughs.aspx (Status: 200)
/_layouts/spusagewebtoppages.aspx (Status: 200)
/_layouts/spusagewebusers.aspx (Status: 200)
/_layouts/ssologon.aspx (Status: 200)
/_layouts/spusagewebreferrers.aspx (Status: 200)
/_layouts/spusagewebhomepage.aspx (Status: 200)
/_layouts/subchoos.aspx (Status: 401)
/_layouts/storman.aspx (Status: 401)
/_layouts/srchvis.aspx (Status: 401)
/_layouts/subedit.aspx (Status: 401)
/_layouts/subnew.aspx (Status: 401)
/_layouts/success.aspx (Status: 401)
/_layouts/submitrepair.aspx (Status: 401)
/_layouts/survedit.aspx (Status: 401)
/_layouts/translatablesettings.aspx (Status: 200)
/_layouts/updateschedule.aspx (Status: 200)
/_layouts/unapprovedresources.aspx (Status: 200)
/_layouts/toolpane.aspx (Status: 200)
/_layouts/templatepick.aspx (Status: 401)
/_layouts/useconfirmation.aspx (Status: 401)
/_layouts/upload.aspx (Status: 401)
/_layouts/tnreord.aspx (Status: 401)
/_layouts/themeweb.aspx (Status: 401)
/_layouts/topnav.aspx (Status: 401)
/_layouts/updatecopies.aspx (Status: 401)
/_layouts/usage.aspx (Status: 401)
/_layouts/usagedetails.aspx (Status: 401)
/_layouts/variationlogs.aspx (Status: 200)
/_layouts/variations/variationimport.aspx (Status: 200)
/_layouts/variationexport.aspx (Status: 200)
/_layouts/variationlabel.aspx (Status: 200)
/_layouts/variationlabels.aspx (Status: 200)
/_layouts/useredit.aspx (Status: 200)
/_layouts/useredit.aspx?id=1&source=%2f%5flayouts%2fpeople%2easpx (Status: 401)
/_layouts/user.aspx (Status: 401)
/_layouts/variationsettings.aspx (Status: 200)
/_layouts/userdisp.aspx (Status: 200)
/_layouts/userdisp.aspx?id=1 (Status: 401)
/_layouts/versiondiff.aspx (Status: 401)
/_layouts/viewgrouppermissions.aspx (Status: 200)
/_layouts/webdeleted.aspx (Status: 200)
/_layouts/vsubwebs.aspx (Status: 401)
/_layouts/viewtype.aspx (Status: 401)
/_layouts/versions.aspx (Status: 401)
/_layouts/viewnew.aspx (Status: 401)
/_layouts/viewscopesettings.aspx (Status: 401)
/_layouts/viewedit.aspx (Status: 401)
/_layouts/viewscopes.aspx (Status: 401)
/_layouts/workflow.aspx (Status: 401)
/_layouts/wrkmng.aspx (Status: 401)
/_layouts/wpprevw.aspx?id=247 (Status: 401)
/_layouts/workspce.aspx (Status: 401)
/_layouts/wrksetng.aspx (Status: 401)
/_layouts/viewlsts.aspx (Status: 200)
/_layouts/webpartgallerypickerpage.aspx (Status: 200)
/_layouts/wsrpmarkupproxy.aspx (Status: 200)
/_layouts/xlatewfassoc.aspx (Status: 200)
/_layouts/wrktaskip.aspx (Status: 200)
/_layouts/xlviewer.aspx (Status: 200)
/_layouts/wpeula.aspx (Status: 200)
/_layouts/zoombldr.aspx (Status: 200)
/_vti_adm/admin.asmx (Status: 200)
/_vti_bin/_vti_adm/admin.dll (Status: 200)
/_vti_bin/_vti_aut/author.dll (Status: 200)
/_vti_bin/alerts.asmx (Status: 200)
/_vti_bin/alertsdisco.aspx (Status: 200)
/_vti_bin (Status: 403)
/_vti_bin/alertswsdl.aspx (Status: 200)
/_vti_bin/authentication.asmx (Status: 200)
/_vti_bin/copy.asmx (Status: 200)
/_vti_bin/dwsdisco.aspx (Status: 200)
/_vti_bin/dspsts.asmx (Status: 200)
/_vti_bin/dspstsdisco.aspx (Status: 200)
/_vti_bin/dspstswsdl.aspx (Status: 200)
/_vti_bin/dws.asmx (Status: 200)
/_vti_bin/dwswsdl.aspx (Status: 200)
/_layouts/wrkstat.aspx (Status: 401)
/_layouts/wpprevw.aspx (Status: 401)
/_vti_bin/formswsdl.aspx (Status: 200)
/_vti_bin/imaging.asmx (Status: 200)
/_vti_bin/imagingdisco.aspx (Status: 200)
/_vti_bin/expurlwp.aspx (Status: 200)
/_vti_bin/listswsdl.aspx (Status: 200)
/_vti_bin/formsdisco.aspx (Status: 200)
/_vti_bin/lists.asmx (Status: 200)
/_vti_bin/listsdisco.aspx (Status: 200)
/_vti_bin/forms.asmx (Status: 200)
/_vti_bin/imagingwsdl.aspx (Status: 200)
/_vti_bin/exportwp.aspx (Status: 200)
/_vti_bin/meetings.asmx (Status: 200)
/_vti_bin/meetingsdisco.aspx (Status: 200)
/_vti_bin/meetingswsdl.aspx (Status: 200)
/_vti_bin/people.asmx (Status: 200)
/_vti_bin/permissions.asmx (Status: 200)
/_vti_bin/permissionsdisco.aspx (Status: 200)
/_vti_bin/permissionswsdl.aspx (Status: 200)
/_vti_bin/owssvr.dll (Status: 401)
/_vti_bin/publishedlinksservice.asmx (Status: 200)
/_vti_bin/search.asmx (Status: 200)
/_vti_bin/searchdisco.aspx (Status: 200)
/_vti_bin/sharepointemailws.asmx (Status: 200)
/_vti_bin/searchwsdl.aspx (Status: 200)
/_vti_bin/shtml.dll (Status: 200)
/_vti_bin/sitedata.asmx (Status: 200)
/_vti_bin/sitedatadisco.aspx (Status: 200)
/_vti_bin/sites.asmx (Status: 200)
/_vti_bin/sitesdisco.aspx (Status: 200)
/_vti_bin/siteswsdl.aspx (Status: 200)
/_vti_bin/sitedatawsdl.aspx (Status: 200)
/_vti_bin/spdisco.aspx (Status: 200)
/_vti_bin/usergroup.asmx (Status: 200)
/_vti_bin/usergroupwsdl.aspx (Status: 200)
/_vti_bin/spsearch.asmx (Status: 200)
/_vti_bin/usergroupdisco.aspx (Status: 200)
/_vti_bin/versions.asmx (Status: 200)
/_vti_bin/versionsdisco.aspx (Status: 200)
/_vti_bin/viewswsdl.aspx (Status: 200)
/_vti_bin/webpartpageswsdl.aspx (Status: 200)
/_vti_bin/webpartpagesdisco.aspx (Status: 200)
/_vti_bin/webs.asmx (Status: 200)
/_vti_bin/versionswsdl.aspx (Status: 200)
/_vti_bin/webpartpages.asmx (Status: 200)
/_vti_bin/viewsdisco.aspx (Status: 200)
/_vti_bin/views.asmx (Status: 200)
/_vti_bin/microsoft.sharepoint.xml (Status: 200)
/_vti_bin/webswsdl.aspx (Status: 200)
/_vti_bin/websdisco.aspx (Status: 200)
/_vti_inf.html (Status: 200)
/_wpresources (Status: 403)
/_vti_pvt (Status: 403)
/alerts.asmx (Status: 200)
/app_browsers (Status: 403)
/areaservice.asmx (Status: 200)
/app_globalresources (Status: 403)
/aspnet_client (Status: 403)
/bin (Status: 403)
/default.aspx (Status: 200)
/dspsts.asmx (Status: 200)
/dws.asmx (Status: 200)
/docs/_layouts/viewlsts.aspx (Status: 200)
/forms.asmx (Status: 200)
/imaging.asmx (Status: 200)
/lists.asmx (Status: 200)
/meetings.asmx (Status: 200)
/mysite/_layouts/mysite.aspx (Status: 200)
/outlookadapter.asmx (Status: 200)
/permissions.asmx (Status: 200)
/news/_layouts/viewlsts.aspx (Status: 200)
/shared documents/forms/allitems.aspx (Status: 200)
/sitedata.asmx (Status: 200)
/sites.asmx (Status: 200)
/sitedirectory/_layouts/viewlsts.aspx (Status: 200)
/spscrawl.asmx (Status: 200)
/usergroup.asmx (Status: 200)
/userprofileservice.asmx (Status: 200)
/versions.asmx (Status: 200)
/views.asmx (Status: 200)
/webpartpages.asmx (Status: 200)
/webs.asmx (Status: 200)
/wpresources (Status: 403)
```


one specific sharepoint that is useful to look at usually is /sitedirectory/_layouts/viewlsts.aspx
also /shared documents/forms/allitems.aspx is a good one to look at

![](@attachment/Clipboard_2020-09-03-10-54-00.png)

going into the documents folder reveals ftp-details.docx
![](@attachment/Clipboard_2020-09-03-10-55-01.png)

![](@attachment/Clipboard_2020-09-03-11-18-54.png)

we still have no username to login to though

looking to the sitepages, we see there is one page, but it is not allowing us to see it due to it adding on http://10.10.10.59/_layouts/15/start.aspx#/SitePages/Forms/AllPages.aspx

we just need to change this to http://10.10.10.59/SitePages/Forms/AllPages.aspx and we will see the site pages correctly

![](@attachment/Clipboard_2020-09-03-11-15-20.png)

we can now login to ftp_user:UTDRSCH53c"$6hys

from the message on the sitemap we see that there are two main users to look at, tim and sarah

sarah has a notes.txt file
```

done

install Sharepoint, replace Orchard CMS

to do

uninstall SQL Server 2016

```

tim has a keepass db file that we can get off the machine and possibly crack the password using john and keepass2john, then using keepass2 to login to the db

make sure when transferring files, to switch to binary in ftp

![](@attachment/Clipboard_2020-09-03-12-36-44.png)

once we crack the password, we can look into the db and there is an ACCT Finance credentials, we can grab those and then log into the share using smbclient

looking through the dirs on the share, the zz_ ones are of interest, looking into the seconds shows the mssql server creds for the old db, and that there there is an updated one for tally

inside of zz_migration, we can go into the binaries, and just start looking for exe's that are of strings. there is one file within the new folder created that is called tester.exe, that seems to be custom made since there is no known application called tester.exe

running strings on the file gives us a password to the database

using sqsh we can login to the sa user for the mssql server running and use the xp_cmdshell to give us a reverse shell
  - refer to starting point to see how to do this, don't forget the go command

once we are in and on sarah's desktop, there are 2 files of interest, once file is a xml file which reveals the ps1 file is running every hour, so we can just echo a reverse shell call into that file and wait for the hour!

after the hour we get a reverse shell!





