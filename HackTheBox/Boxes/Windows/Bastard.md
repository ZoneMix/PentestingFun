---
attachments: [Clipboard_2020-09-02-00-13-58.png, Clipboard_2020-09-02-00-15-36.png, Clipboard_2020-09-02-02-26-08.png, Clipboard_2020-09-02-02-26-24.png]
tags: [HTB]
title: Bastard
created: '2020-09-02T04:45:41.311Z'
modified: '2020-09-03T05:15:34.559Z'
---

# Bastard
- 10.10.10.9

- port 80 powered by drupal
- tool to use is dropescan
- /CHANGELOG.txt shows the version of drupal 7.54
- looking up the exploits there is one for 7.x RCE
- we can modify the php to give us a better 
![](@attachment/Clipboard_2020-09-02-00-15-36.png)
- the path for the rest_endpoint is rest
- once we have the correct rest_api path within the exploit we can execute it to obtain our fexec command
- using the shell.ps1 and using powershell download string we get a reverse shell
- uploading sherlock.ps1 and running it we see it is vulnerable to ms15-051 which we can use to use to run commands as high-priv ntauth\sys
- uploading nc64.exe and using that to connect back with ms15-051 allows for an ntauth\sys shell
![](@attachment/Clipboard_2020-09-02-02-26-08.png)
![](@attachment/Clipboard_2020-09-02-02-26-24.png)


